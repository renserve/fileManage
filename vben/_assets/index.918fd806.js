import{cW as r,a as e,g as o,U as a,N as t,C as i,cr as s,b9 as n,r as l,o as c,b as d,aA as f,b8 as u,a9 as m,aa as b,n as p,w as g,v as j,q as E}from"./index.89b15553.js";import"./useFullScreen.cdc3e2b6.js";import{r as y}from"./index.0840873e.js";import{b as x}from"./index.8bcfaa1f.js";import"./index.748f688a.js";import"./index.943ccd56.js";import"./zh_CN.0242bd16.js";import"./index.efb28955.js";import"./index.3556b535.js";import"./CheckOutlined.ba9f163b.js";import{s as R,u as C}from"./useTable.87b11629.js";import"./upload.3612133c.js";import"./index.0bfdb95a.js";import"./useWindowSizeFn.7be1f756.js";import"./domUtils.a209b89e.js";import{getColumns as h}from"./data.2bfc47d7.js";import k from"./DetailModal.d510b1c9.js";var w;(w||(w={})).Error="/error";var T=e({name:"ErrorHandler",components:{DetailModal:k,BasicTable:R,TableAction:y},setup(){const e=o(),l=o([]),{t:c}=a("sys.errorLog"),[d,{setTableData:f}]=C({title:c("sys.errorLog.tableTitle"),columns:h(),actionColumn:{width:80,title:"Action",dataIndex:"action",slots:{customRender:"action"}}}),[u,{openModal:m}]=x();return t((()=>n.getErrorInfoState),(r=>{i((()=>{f(s(r))}))}),{immediate:!0}),{register:d,registerModal:u,handleDetail:function(r){e.value=r,m(!0)},fireVueError:function(){throw new Error("fire vue error!")},fireResourceError:function(){l.value.push(`${(new Date).getTime()}.png`)},fireAjaxError:async function(){await r.request({url:w.Error,method:"GET"})},imgListRef:l,rowInfoRef:e,t:c}}});const A={class:"p-4"};T.render=function(r,e,o,a,t,i){const s=l("DetailModal"),n=l("a-button"),y=l("TableAction"),x=l("BasicTable");return c(),d("div",A,[(c(!0),d(f,null,u(r.imgListRef,(r=>m((c(),d("img",{key:r,src:r},null,8,["src"])),[[b,!1]]))),128)),p(s,{info:r.rowInfoRef,onRegister:r.registerModal},null,8,["info","onRegister"]),p(x,{onRegister:r.register,class:"error-handle-table"},{toolbar:g((()=>[p(n,{onClick:r.fireVueError,type:"primary"},{default:g((()=>[j(E(r.t("sys.errorLog.fireVueError")),1)])),_:1},8,["onClick"]),p(n,{onClick:r.fireResourceError,type:"primary"},{default:g((()=>[j(E(r.t("sys.errorLog.fireResourceError")),1)])),_:1},8,["onClick"]),p(n,{onClick:r.fireAjaxError,type:"primary"},{default:g((()=>[j(E(r.t("sys.errorLog.fireAjaxError")),1)])),_:1},8,["onClick"])])),action:g((({record:e})=>[p(y,{actions:[{label:r.t("sys.errorLog.tableActionDesc"),onClick:r.handleDetail.bind(null,e)}]},null,8,["actions"])])),_:1},8,["onRegister"])])};export default T;
