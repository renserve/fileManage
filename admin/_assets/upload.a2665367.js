import{n as e,m as t,aL as r,a as n,h as o,g as i,c as s,af as a,Q as l,bb as u,i as c,cU as m,cV as d,cW as g}from"./index.7ca95812.js";import{C as p,R as f}from"./index.d6dca0ee.js";var v={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"};function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=function(n,o){var i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){w(e,t,r[t])}))}return e}({},n,o.attrs);return e(r,t(i,{icon:v}),null)};h.displayName="LeftOutlined",h.inheritAttrs=!1;const _={show:{type:Boolean,default:!1},imageList:{type:[Array],default:null},index:{type:Number,default:0}};var L,O;(O=L||(L={}))[O.LOADING=0]="LOADING",O[O.DONE=1]="DONE",O[O.FAIL=2]="FAIL";const y="img-preview";var b=n({name:"ImagePreview",props:_,setup(e){const t=o({currentUrl:"",imgScale:1,imgRotate:0,imgTop:0,imgLeft:0,status:0,currentIndex:0,moveX:0,moveY:0,show:e.show}),r=i(null),n=i(null);function m(){!function(){const e=c(r);if(!e)return;e.onmousewheel=g,document.body.addEventListener("DOMMouseScroll",g),document.body.onkeyup=b,document.ondragstart=function(){return!1}}();const{index:n,imageList:o}=e;if(!o||!o.length)throw new Error("imageList is undefined");t.currentIndex=n,L(o[n])}function d(){t.imgScale=1,t.imgRotate=0,t.imgTop=0,t.imgLeft=0}function g(e){(e=e||window.event).delta=e.wheelDelta||-e.detail,e.preventDefault(),e.delta>0&&v(.015),e.delta<0&&v(-.015)}function v(e){t.imgScale<=.2&&e<0||(t.imgScale+=e)}function w(e){t.imgRotate+=e}function _(){const e=c(n);e&&(e.onmousemove=null)}function L(e){t.status=0;const r=new Image;r.src=e,r.onload=()=>{t.currentUrl=e,t.status=1},r.onerror=()=>{t.status=2}}function O(e){e&&e.stopPropagation(),t.show=!1,document.body.removeEventListener("DOMMouseScroll",g),document.ondragstart=null}function b(e){let r;r=(e=e||event).keyCode||e.which||e.charCode,27==r&&(t.show=!1)}function x(){d()}function I(e){e=e||window.event,t.moveX=e.clientX,t.moveY=e.clientY;const r=c(n);r&&(r.onmousemove=F)}function F(e){(e=e||window.event).preventDefault();const r=e.clientX-t.moveX,n=e.clientY-t.moveY;t.imgLeft+=r,t.imgTop+=n,t.moveX=e.clientX,t.moveY=e.clientY}const G=s((()=>{const{imgScale:e,imgRotate:r,imgTop:n,imgLeft:o}=t;return{transform:`scale(${e}) rotate(${r}deg)`,marginTop:`${n}px`,marginLeft:`${o}px`}})),T=s((()=>{const{imageList:t}=e;return t.length>1}));a((()=>{e.show&&m(),e.imageList&&d()}));const P=r=>c(T)?l("div",{class:["img-preview__arrow",r],onClick:()=>function(r){const{currentIndex:n}=t,{imageList:o}=e;"left"===r&&(t.currentIndex--,n<=0&&(t.currentIndex=o.length-1)),"right"===r&&(t.currentIndex++,n>=o.length-1&&(t.currentIndex=0)),L(o[t.currentIndex])}(r)},l("left"===r?h:f,null)):null;return()=>t.show&&l("div",{class:y,ref:r,onMouseup:_},l("div",{class:"img-preview-content"},l("img",{width:"32",src:u,class:["img-preview-image",0===t.status?"":"hidden"]}),l("img",{style:c(G),class:["img-preview-image",1===t.status?"":"hidden"],ref:n,src:t.currentUrl,onMousedown:I}),l("div",{class:"img-preview__close",onClick:O},l(p,{class:"img-preview__close-icon"})),(()=>{if(!c(T))return null;const{currentIndex:r}=t,{imageList:n}=e;return l("div",{class:"img-preview__index"},r+1," / ",n.length)})(),l("div",{class:"img-preview__controller"},l("div",{class:"img-preview__controller-item",onClick:()=>v(-.15)},l("img",{src:"/_assets/unscale.50a147e7.svg"})),l("div",{class:"img-preview__controller-item",onClick:()=>v(.15)},l("img",{src:"/_assets/scale.5b254733.svg"})),l("div",{class:"img-preview__controller-item",onClick:x},l("img",{src:"/_assets/resume.7a838909.svg"})),l("div",{class:"img-preview__controller-item",onClick:()=>w(-90)},l("img",{src:"/_assets/unrotate.a3dc2050.svg"})),l("div",{class:"img-preview__controller-item",onClick:()=>w(90)},l("img",{src:"/_assets/p-rotate.54a3ac67.svg"}))),P("left"),P("right")))}});let x=null;function I(t){if(!m)return;const{imageList:r,show:n=!0,index:o=0}=t,i={},s=document.createElement("div");i.imageList=r,i.show=n,i.index=o,x=e(b,i),d(x,s),document.body.appendChild(s)}var F,G;function T(e,t){return g.request({url:F.FileGroupOperate,method:"GET",params:{type:e,...t}},{isTransformRequestResult:!1})}function P(e,t){return g.request({url:F.FileGroupOperate,method:"POST",params:{type:e,...t}})}function E(e,t){return g.request({url:F.RecoverFileGroupOperate,method:"PUT",params:{type:e,...t}})}function q(e,t){return g.request({url:F.FileGroupOperate,method:"DELETE",params:{type:e,...t}})}function C(e){return g.request({url:F.FileGroupOperate,method:"PUT",params:e})}function D(e){return g.request({url:F.FileGroup,method:"GET",params:e},{isTransformRequestResult:!1})}function R(e){return g.request({url:F.FileGroup,method:"POST",params:e})}function S(e){return g.request({url:F.FileGroup+"/"+e.id,method:"PUT",params:e})}function k(e,t){return g.request({url:F.FileGroup+"/"+e,method:"delete"})}function U(e,t){return g.uploadFile({url:F.uploadBigImg,onUploadProgress:t},e)}function j(e,t){return g.uploadFile({url:F.uploadImg,onUploadProgress:t},e)}(G=F||(F={})).uploadImg="/cms/file",G.uploadBigImg="/cms/bigfile",G.FileGroup="/cms/file_group",G.FileGroupOperate="/cms/file_group/file",G.RecoverFileGroupOperate="/cms/file_group/recover/file";export{h as L,P as a,U as b,I as c,q as d,D as e,S as f,T as g,k as h,C as i,E as r,R as s,j as u};
