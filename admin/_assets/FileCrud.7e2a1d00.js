let e=document.createElement("style");e.innerHTML="[data-v-59dea3c7] .collapse-container__body{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}[data-v-59dea3c7] .collapse-container__body form{max-width:880px;-webkit-box-flex:1;-ms-flex:1;flex:1;margin-right:100px}[data-v-59dea3c7] .collapse-container__body button{-webkit-box-flex:0;-ms-flex:0;flex:0}",document.head.appendChild(e);import{n as t,m as a,aL as i,a as l,g as s,J as r,h as o,c as n,k as c,bh as d,p,l as u,r as m,o as f,b,e as h,v as g,q as y,aA as v,s as w}from"./index.c36a6c67.js";import"./useFullScreen.224b34a5.js";import{B as D,u as j}from"./index.fb588b86.js";import"./index.1878d1f8.js";import"./index.c6464e5c.js";import"./index.9a71361f.js";import"./zh_CN.0242bd16.js";import{C as x}from"./index.078abd6c.js";import"./CheckOutlined.95037527.js";import{s as O}from"./useTable.48a7e287.js";import{r as S,d as _,a as k,g as F,b as R,s as L,e as C,f as P,u as T}from"./upload.a1da8850.js";import{s as $,c as E}from"./FileTree.7781c5ef.js";import"./_baseDifference.f45380d4.js";import{g as A,u as z}from"./useTable.dbf78051.js";import"./index.da4720b1.js";import"./useWindowSizeFn.49839837.js";import"./domUtils.a209b89e.js";import B from"./Dialog.b464dd48.js";import H from"./SourceList.6de73e7c.js";var I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};function q(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var M=function(e,l){var s=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},i=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),i.forEach((function(t){q(e,t,a[t])}))}return e}({},e,l.attrs);return t(i,a(s,{icon:I}),null)};M.displayName="DeleteOutlined",M.inheritAttrs=!1;var V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M793 242H366v-74c0-6.7-7.7-10.4-12.9-6.3l-142 112a8 8 0 000 12.6l142 112c5.2 4.1 12.9.4 12.9-6.3v-74h415v470H175c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h618c35.3 0 64-28.7 64-64V306c0-35.3-28.7-64-64-64z"}}]},name:"rollback",theme:"outlined"};function W(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var G=function(e,l){var s=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},i=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),i.forEach((function(t){W(e,t,a[t])}))}return e}({},e,l.attrs);return t(i,a(s,{icon:V}),null)};G.displayName="RollbackOutlined",G.inheritAttrs=!1;const{createWarningModal:N,createConfirm:U}=c();var J=l({props:["type","title","maxSize","accept"],components:{BasicForm:D,CollapseContainer:x,FileTree:$,Dialog:B,BasicTable:O,RollbackOutlined:G,DeleteOutlined:M,SourceList:H},data:()=>({isRecycle:0}),methods:{batchRecover(){const e=this.$refs.SourceList.getSelect(),t=this;e.length?U({iconType:"warning",title:`确认批量恢复选中的${this.title}？`,onOk(){S(t.type,{ids:e}).then((e=>{t.reloadFileList()}))}}):N({content:`请选择需要恢复的${this.title}`})},getDeleteData(){this.isRecycle=this.isRecycle?0:1,this.sendData.isDelete=this.isRecycle,this.reloadFileList()},batchSubmit(){const e=this.$refs.SourceList.getSelect(),t=this;e.length?U({iconType:"warning",title:`确认批量${this.isRecycle?"清空":"删除"}选中的${this.title}？`,onOk(){_(t.type,{ids:e,isClear:t.isRecycle}).then((e=>{t.reloadFileList()}))}}):N({content:`请选择需要删除的${this.title}`})},getCurrentList(e){const t=/file/.test(e.id),a=t?e.parent_id:e.id;this.setFieldsValue({folder_id:a}),t?this.showFileList=[{path:e.path,id:e.realId,name:e.name,title:e.title}]:(this.sendData.page=0,this.sendData.folder_id=a,this.reloadFileList())},handleSubmit(e){k(this.type,e).then((e=>{e.error_code||(this.resetFields(),this.setFieldsValue({folder_id:this.sendData.folder_id})),this.reloadFileList()}))}},setup(e,t){const a={fetchSetting:{listField:null},pagination:!1,api:t=>R({...t,type:e.type}),title:"分组"},i=s(!1);r("schemas",A([{label:"父类ID",field:"parent_id",width:120,disabled:!0,rules:[{required:!0,message:"请输入父类ID",type:"number"}]},{label:"类型",field:"type",component:"RadioGroup",componentProps:{options:[{label:"图片",value:"img"},{label:"文本",value:"txt"},{label:"音频",value:"audio"},{label:"视频",value:"video"}]},disabled:!0,rules:[{required:!0,message:"请输入文件类型"}]},{label:"文件夹名称",field:"name",rules:[{required:!0,message:"请输入文件夹名称"}]},{label:"文件夹描述",field:"description"}]));const l=o({id:null,initForm:{parent_id:0,type:e.type},title:"新增"}),c={rowSaveApi:L,rowEditApi:C,rowDeleteApi:P},p=s(null),u=s(null),m=o({page:0,count:30,folder_id:null,isDelete:0}),f=d();function b(){m.page=0;const t=f.refs.SourceList;t&&t.resetSelect(),F(e.type,m).then((e=>{!m.page&&(p.value=[]),p.value=E(p.value,e.items.map((e=>({parent_id:e.folder_id,name:e.path.split("/").pop(),isLeaf:!0,title:e.title,realId:e.id,id:"file_"+e.id,key:"file_"+e.id,path:e.path})))),u.value=p.value.map((e=>({path:e.path,id:e.realId,name:e.name,title:e.title})))}))}b();const[{registerTable:h,isInit:g,getDataSource:y},{registerDialog:v},{rowDelete:w,rowSave:D,rowEdit:x,rowAdd:O}]=z({...a,...c,relyObject:l}),S=n((()=>g()&&y())),_=n((()=>{const t=g()&&y()||[];return[{field:"paths",component:"Upload",label:`${e.title}上传`,colProps:{span:8},rules:[{required:!0,message:`请选择${e.title}文件上传`}],componentProps:{maxSize:e.maxSize,accept:i.value?[]:e.accept,uploadParams:{data:{type:e.type}},api:T}},{field:"folder_id",colProps:{span:8},rules:[{required:!0,message:`请选择${e.title}所属文件分类`,type:"number"}],component:"Select",componentProps:{options:t.map((e=>({label:e.name,value:e.id})))},disabled:!0,label:`${e.title}分类`}]})),[k,{setFieldsValue:$,resetFields:B}]=j({labelWidth:130,schemas:_,actionColOptions:{span:8},resetButtonOptions:{text:"重新上传"},submitButtonOptions:{text:"提交文件"}});return{sendData:m,leafData:p,fileExpand:i,showFileList:u,reloadFileList:b,register:k,setFieldsValue:$,resetFields:B,registerTable:h,treeData:S,registerDialog:v,rowDelete:w,rowSave:D,rowEdit:x,rowAdd:O,relyObject:l}}});const K=w("data-v-59dea3c7");p("data-v-59dea3c7");const Q={class:"imgWrapper"},X=t("span",null,"类型扩展",-1),Y=g("批量恢复"),Z={key:0},ee=g(" 返回 "),te={key:1},ae=g(" 回收站 ");u();const ie=K(((e,a,i,l,s,r)=>{const o=m("a-switch"),n=m("a-tooltip"),c=m("BasicForm"),d=m("a-button"),p=m("RollbackOutlined"),u=m("DeleteOutlined"),w=m("CollapseContainer"),D=m("a-alert"),j=m("SourceList"),x=m("FileTree"),O=m("Dialog"),S=m("BasicTable");return f(),b("div",Q,[t(w,{title:e.title+"上传"},{default:K((()=>[t(n,{placement:"top"},{title:K((()=>[X])),default:K((()=>[t(o,{"checked-children":"开","un-checked-children":"关",checked:e.fileExpand,"onUpdate:checked":a[1]||(a[1]=t=>e.fileExpand=t)},null,8,["checked"])])),_:1}),t(c,{onRegister:e.register,onSubmit:e.handleSubmit},null,8,["onRegister","onSubmit"]),t("div",null,[e.isRecycle?(f(),b(d,{key:0,class:"mr_btn",type:"primary",onClick:a[2]||(a[2]=t=>e.batchRecover())},{default:K((()=>[Y])),_:1})):h("",!0),t(d,{class:"mr_btn",type:"danger",onClick:a[3]||(a[3]=t=>e.batchSubmit())},{default:K((()=>[g("批量"+y(e.isRecycle?"清空":"删除"),1)])),_:1}),t(d,{type:e.isRecycle?"primary":"default",onClick:a[4]||(a[4]=t=>e.getDeleteData())},{default:K((()=>[e.isRecycle?(f(),b("div",Z,[t(p),ee])):(f(),b("div",te,[t(u),ae]))])),_:1},8,["type"])])])),_:1},8,["title"]),t(x,{leafData:e.leafData,treeData:e.treeData,onCurrentClass:e.getCurrentList,onRowDelete:e.rowDelete,onRowAdd:a[5]||(a[5]=t=>e.rowAdd(e.$refs.Dialog,t)),onRowEdit:a[6]||(a[6]=t=>e.rowEdit(e.$refs.Dialog,Object.assign(e.relyObject.initForm,t)))},{default:K((()=>[e.leafData?(f(),b(v,{key:0},[e.isRecycle?(f(),b(D,{key:0,message:"当前展示内容为回收站内容",banner:""})):h("",!0),t(j,{type:e.type,ref:"SourceList",gapGroup:e.isRecycle?e.showFileList.length:6,showFileList:e.showFileList},null,8,["type","gapGroup","showFileList"])],64)):h("",!0)])),_:1},8,["leafData","treeData","onCurrentClass","onRowDelete"]),t(O,{ref:"Dialog",onRowSave:e.rowSave,title:e.relyObject.title,onRegister:e.registerDialog},null,8,["onRowSave","title","onRegister"]),t(S,{isFake:!0,onRegister:e.registerTable},null,8,["onRegister"])])}));J.render=ie,J.__scopeId="data-v-59dea3c7";export default J;
